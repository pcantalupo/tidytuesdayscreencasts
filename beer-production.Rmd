---
title: "BeerProduction"
author: "PGC"
date: "4/16/2020"
output: html_document
editor_options: 
  chunk_output_type: console
---

# Stopped [here ~7min](https://www.youtube.com/watch?v=1R4X09w7tQ8)

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
library(tidyverse)
library(lubridate)
theme_set(theme_light())

brewing_materials <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-31/brewing_materials.csv') %>% 
  mutate(date = ymd(paste(year, month , 1))) %>%
  filter(year < 2016)
beer_taxed <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-31/beer_taxed.csv')
brewer_size <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-31/brewer_size.csv')
beer_states <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-31/beer_states.csv')
```


```{r}
brewing_materials %>% count(material_type, type)

beer_taxed %>% count(tax_status)

brewer_size

beer_states
```


What ingredients are used in US beer prod.
```{r}
# Using forcats to reorder a factor variable based on numeric value in another column
brewing_materials %>%
  filter(date == max(date)) %>%
  filter(!str_detect(material_type, "Total")) %>%
  mutate(type = fct_reorder(type, month_current)) %>%
  ggplot(aes(type, month_current, fill=material_type)) +
  geom_col() + 
  coord_flip()

brewing_materials %>%
  filter(!str_detect(material_type, "Total")) %>%
  mutate(type = fct_reorder(type, month_current, sum )) %>%
  ggplot(aes(date, month_current, fill=type)) +
  geom_col() +
  scale_y_continuous(labels = scales::comma) +
  labs(x = "Time",
       y = "Pounds used in beer production",
       fill="type")


brewing_materials %>%
  filter(str_detect(material_type, "Total.*products")) %>%
  mutate(type = fct_reorder(type, month_current, sum )) %>%
  ggplot(aes(date, month_current, fill=type)) +
  geom_col() +
  scale_y_continuous(labels = scales::comma) +
  labs(x = "Time",
       y = "Pounds used in beer production",
       fill="type")

```






